{"version":3,"sources":["webpack:///./src/assets/img/left_black.png","webpack:///./src/views/Chat.vue?a2bc","webpack:///src/views/Chat.vue","webpack:///./src/views/Chat.vue?6ed9","webpack:///./src/views/Chat.vue","webpack:///./src/assets/css/views/home.css?f812","webpack:///./src/assets/css/components/chat.css?ba35"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","back","_v","_s","$conversacionElegida","user_dest","name","ref","onScroll","_l","mensaje","key","id","class","sender_id","userId","message_type","substr","message","_e","esArchivo","esImagen","esVideo","esAudio","adjuntar","changeAdjunto","staticStyle","type","indexOf","_k","keyCode","enviar","staticRenderFns","components","MensajeTexto","MensajeArchivo","MensajeImagen","MensajeVideo","MensajeAudio","data","mensajes","primeraPagina","currentPage","lastPage","mensajeOffset","props","computed","mounted","localStorage","getItem","getChat","actualizar","$refs","chatScroll","addEventListener","created","$eventHub","$on","methods","that","setTimeout","extension","files","file","split","toLowerCase","$route","params","$axios","getChatPage","pagina","pag","target","scrollTop","clientHeight","offset","limit","scrollToBottom","$nextTick","document","getElementById","texto","inputTexto","value","FormData","append","user_dest_id","isOverflown","adjuntoFiles","click","length","forEach","i","component"],"mappings":"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","file":"js/chat.3fa64018.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAqCAYAAAD1T9h6AAAABHNCSVQICAgIfAhkiAAAAVlJREFUWEfV2c1Nw0AQQOGXAhCUkBLoAOgESsiFHuggR1JBOHIDUQEUgEQJHDhyiCayI8da/86sd8b3jN+3q0ReZ4XtdQXsgQ3waTs6PW1leBOJfwOugV/gbgmEFaAZX6/JIggLQCpeEF/AbbUbhht9PkoLKBovFA2geLwG4CJ+LsBN/ByAq/ipAHfxUwAu48cC3MaPAbiOHwK4j+8DhIjvAoSJTwFCxbcB4eKbgJDxNaAr/q86Uf1ne5jXD97K4/Q7cKOfVWTCowDkDCuIyyIJupseAXJFRZwANeIDuGgtyhPwqluobJ/+bh8pu3biAXjOlqEYnDoTh0J0HerDIPreSoRADL1WcY8YAvT9xLr4Yo8BuEaMBbhFTAG4REwFuEPMAbhCzAW4QWgALhBaQHGEBaAPIX/0yWEp22UFSCF2wH228mqwJaCJeFkiXm5oDZCZa+An98rX8w+YCmb+NJKbQwAAAABJRU5ErkJggg==\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home\"},[_c('div',{staticClass:\"home-body\"},[_c('div',{staticClass:\"home-right\"},[_c('div',{staticClass:\"chat\"},[_c('div',{staticClass:\"chat-top\"},[_c('img',{attrs:{\"src\":require(\"../assets/img/left_black.png\")},on:{\"click\":function($event){return _vm.$router.back()}}}),_c('p',{on:{\"click\":function($event){return _vm.$router.back()}}},[_vm._v(\" \"+_vm._s(_vm.$conversacionElegida != null ? _vm.$conversacionElegida.user_dest.name : \"\")+\" \")])]),_c('div',{ref:\"chatScroll\",staticClass:\"chat-scroll\",attrs:{\"id\":\"chatScroll\"},on:{\"scroll\":_vm.onScroll}},_vm._l((_vm.mensajes),function(mensaje){return _c('div',{key:mensaje.id,staticClass:\"chat-container\",class:{\n              'chat-mensaje-propio': mensaje.sender_id == _vm.userId\n            },attrs:{\"id\":mensaje.id}},[(\n                mensaje.message_type != null &&\n                  mensaje.message_type.substr(11, 100) == 'TextMessage'\n              )?_c('MensajeTexto',{attrs:{\"mensaje\":mensaje.message}}):_vm._e(),(\n                mensaje.message_type != null &&\n                  mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                  _vm.esArchivo(mensaje)\n              )?_c('MensajeArchivo',{attrs:{\"mensaje\":mensaje.message}}):_vm._e(),(\n                mensaje.message_type != null &&\n                  mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                  _vm.esImagen(mensaje)\n              )?_c('MensajeImagen',{attrs:{\"mensaje\":mensaje.message}}):_vm._e(),(\n                mensaje.message_type != null &&\n                  mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                  _vm.esVideo(mensaje)\n              )?_c('MensajeVideo',{attrs:{\"mensaje\":mensaje.message}}):_vm._e(),(\n                mensaje.message_type != null &&\n                  mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                  _vm.esAudio(mensaje)\n              )?_c('MensajeAudio',{attrs:{\"mensaje\":mensaje.message}}):_vm._e()],1)}),0),_c('div',{staticClass:\"chat-bottom\"},[_c('div',{staticClass:\"chat-adjuntar\",attrs:{\"title\":\"Adjuntar\"},on:{\"click\":function($event){return _vm.adjuntar()}}},[_c('input',{ref:\"adjuntoFiles\",staticClass:\"app-hide\",attrs:{\"type\":\"file\",\"multiple\":\"\"},on:{\"change\":function($event){return _vm.changeAdjunto()}}}),_c('svg',{staticStyle:{\"display\":\"block\"},attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"width\":\"24\",\"height\":\"24\"}},[_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M1.816 15.556v.002c0 1.502.584 2.912 1.646 3.972s2.472 1.647 3.974 1.647a5.58 5.58 0 0 0 3.972-1.645l9.547-9.548c.769-.768 1.147-1.767 1.058-2.817-.079-.968-.548-1.927-1.319-2.698-1.594-1.592-4.068-1.711-5.517-.262l-7.916 7.915c-.881.881-.792 2.25.214 3.261.959.958 2.423 1.053 3.263.215l5.511-5.512c.28-.28.267-.722.053-.936l-.244-.244c-.191-.191-.567-.349-.957.04l-5.506 5.506c-.18.18-.635.127-.976-.214-.098-.097-.576-.613-.213-.973l7.915-7.917c.818-.817 2.267-.699 3.23.262.5.501.802 1.1.849 1.685.051.573-.156 1.111-.589 1.543l-9.547 9.549a3.97 3.97 0 0 1-2.829 1.171 3.975 3.975 0 0 1-2.83-1.173 3.973 3.973 0 0 1-1.172-2.828c0-1.071.415-2.076 1.172-2.83l7.209-7.211c.157-.157.264-.579.028-.814L11.5 4.36a.572.572 0 0 0-.834.018l-7.205 7.207a5.577 5.577 0 0 0-1.645 3.971z\"}})])]),_c('input',{ref:\"inputTexto\",attrs:{\"type\":\"text\",\"placeholder\":\"Escribe un mensaje aquí\"},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.enviar()}}}),_c('button',{staticClass:\"chat-enviar\",on:{\"click\":function($event){return _vm.enviar()}}},[_vm._v(\"Enviar\")])])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"home\">\n    <div class=\"home-body\">\n      <div class=\"home-right\">\n        <div class=\"chat\">\n          <div class=\"chat-top\">\n            <img @click=\"$router.back()\" src=\"../assets/img/left_black.png\" />\n            <p @click=\"$router.back()\">\n              {{\n                $conversacionElegida != null\n                  ? $conversacionElegida.user_dest.name\n                  : \"\"\n              }}\n            </p>\n          </div>\n          <div\n            id=\"chatScroll\"\n            class=\"chat-scroll\"\n            ref=\"chatScroll\"\n            @scroll=\"onScroll\"\n          >\n            <div\n              v-for=\"mensaje in mensajes\"\n              :key=\"mensaje.id\"\n              :id=\"mensaje.id\"\n              class=\"chat-container\"\n              v-bind:class=\"{\n                'chat-mensaje-propio': mensaje.sender_id == userId\n              }\"\n            >\n              <MensajeTexto\n                v-if=\"\n                  mensaje.message_type != null &&\n                    mensaje.message_type.substr(11, 100) == 'TextMessage'\n                \"\n                :mensaje=\"mensaje.message\"\n              ></MensajeTexto>\n              <MensajeArchivo\n                v-if=\"\n                  mensaje.message_type != null &&\n                    mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                    esArchivo(mensaje)\n                \"\n                :mensaje=\"mensaje.message\"\n              ></MensajeArchivo>\n              <MensajeImagen\n                v-if=\"\n                  mensaje.message_type != null &&\n                    mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                    esImagen(mensaje)\n                \"\n                :mensaje=\"mensaje.message\"\n              ></MensajeImagen>\n              <MensajeVideo\n                v-if=\"\n                  mensaje.message_type != null &&\n                    mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                    esVideo(mensaje)\n                \"\n                :mensaje=\"mensaje.message\"\n              ></MensajeVideo>\n              <MensajeAudio\n                v-if=\"\n                  mensaje.message_type != null &&\n                    mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                    esAudio(mensaje)\n                \"\n                :mensaje=\"mensaje.message\"\n              ></MensajeAudio>\n            </div>\n          </div>\n\n          <div class=\"chat-bottom\">\n            <div class=\"chat-adjuntar\" title=\"Adjuntar\" @click=\"adjuntar()\">\n              <input\n                type=\"file\"\n                class=\"app-hide\"\n                @change=\"changeAdjunto()\"\n                ref=\"adjuntoFiles\"\n                multiple\n              />\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 24 24\"\n                width=\"24\"\n                height=\"24\"\n                style=\"display: block;\"\n              >\n                <path\n                  fill=\"currentColor\"\n                  d=\"M1.816 15.556v.002c0 1.502.584 2.912 1.646 3.972s2.472 1.647 3.974 1.647a5.58 5.58 0 0 0 3.972-1.645l9.547-9.548c.769-.768 1.147-1.767 1.058-2.817-.079-.968-.548-1.927-1.319-2.698-1.594-1.592-4.068-1.711-5.517-.262l-7.916 7.915c-.881.881-.792 2.25.214 3.261.959.958 2.423 1.053 3.263.215l5.511-5.512c.28-.28.267-.722.053-.936l-.244-.244c-.191-.191-.567-.349-.957.04l-5.506 5.506c-.18.18-.635.127-.976-.214-.098-.097-.576-.613-.213-.973l7.915-7.917c.818-.817 2.267-.699 3.23.262.5.501.802 1.1.849 1.685.051.573-.156 1.111-.589 1.543l-9.547 9.549a3.97 3.97 0 0 1-2.829 1.171 3.975 3.975 0 0 1-2.83-1.173 3.973 3.973 0 0 1-1.172-2.828c0-1.071.415-2.076 1.172-2.83l7.209-7.211c.157-.157.264-.579.028-.814L11.5 4.36a.572.572 0 0 0-.834.018l-7.205 7.207a5.577 5.577 0 0 0-1.645 3.971z\"\n                />\n              </svg>\n            </div>\n            <input\n              type=\"text\"\n              placeholder=\"Escribe un mensaje aquí\"\n              ref=\"inputTexto\"\n              v-on:keyup.enter=\"enviar()\"\n            />\n            <button class=\"chat-enviar\" @click=\"enviar()\">Enviar</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport MensajeTexto from \"@/components/MensajeTexto.vue\";\nimport MensajeArchivo from \"@/components/MensajeArchivo.vue\";\nimport MensajeImagen from \"@/components/MensajeImagen.vue\";\nimport MensajeVideo from \"@/components/MensajeVideo.vue\";\nimport MensajeAudio from \"@/components/MensajeAudio.vue\";\n\nexport default {\n  name: \"Chat\",\n  components: {\n    MensajeTexto,\n    MensajeArchivo,\n    MensajeImagen,\n    MensajeVideo,\n    MensajeAudio\n  },\n  data() {\n    return {\n      mensajes: [],\n      userId: null,\n      primeraPagina: true,\n      currentPage: 0,\n      lastPage: 0,\n      mensajeOffset: null\n    };\n  },\n  props: {},\n  computed: {},\n  mounted() {\n    this.userId = localStorage.getItem(\"$userId\");\n    this.getChat();\n    this.actualizar();\n    this.mensajes = [];\n    this.$refs.chatScroll.addEventListener(\"touchmove\", this.onScroll);\n  },\n  created() {\n    this.$eventHub.$on(\"chat-get\", id => this.getChat(id));\n  },\n  methods: {\n    actualizar() {\n      var that = this;\n      setTimeout(function() {\n        that.getChat();\n        that.actualizar();\n      }, 3000);\n    },\n    esImagen(mensaje) {\n      var extension = mensaje.message.files[0].file.split(\".\")[1].toLowerCase();\n      if (\n        extension == \"png\" ||\n        extension == \"jpg\" ||\n        extension == \"svg\" ||\n        extension == \"jpeg\"\n      ) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n    esVideo(mensaje) {\n      var extension = mensaje.message.files[0].file.split(\".\")[1].toLowerCase();\n      if (\n        extension == \"webm\" ||\n        extension == \"mkv\" ||\n        extension == \"flv\" ||\n        extension == \"mp4\" ||\n        extension == \"mov\" ||\n        extension == \"avi\"\n      ) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n    esAudio(mensaje) {\n      var extension = mensaje.message.files[0].file.split(\".\")[1].toLowerCase();\n      if (extension == \"m4a\" || extension == \"qt\") {\n        return true;\n      } else {\n        return false;\n      }\n    },\n    esArchivo(mensaje) {\n      if (\n        this.esImagen(mensaje) == false &&\n        this.esVideo(mensaje) == false &&\n        this.esAudio(mensaje) == false\n      ) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n    getChat(id) {\n      if (id == null) {\n        id = this.$route.params.id;\n      } else {\n        this.mensajes = [];\n        this.primeraPagina = true;\n      }\n      var that = this;\n      this.$axios\n        .get(this.$localurl + \"/api/v1/messages/\" + id)\n        .then(function(response) {\n          if (\n            that.primeraPagina == true &&\n            !that.isOverflown(document.getElementById(\"chatScroll\"))\n          ) {\n            that.primeraPagina = false;\n            that.getChatPage(2);\n          }\n          var scrollear = false;\n          that.lastPage = response.data.messages.last_page;\n          response.data.messages.data.reverse();\n          response.data.messages.data.forEach(m => {\n            if (\n              !that.mensajes.some(mensaje => mensaje.id == m.id) &&\n              m.conversation_id == that.$route.params.id\n            ) {\n              that.mensajes.push(m);\n              scrollear = true;\n            }\n          });\n          if (scrollear == true) {\n            that.mensajeOffset = that.mensajes[that.mensajes.length - 1];\n            that.scrollToBottom();\n          }\n        })\n        .catch(function(response) {\n          if (response.response.status == 401) {\n            localStorage.removeItem(\"$expire\");\n            that.$router.push(\"/login\");\n          }\n        });\n    },\n    getChatPage(pagina) {\n      this.mensajeOffset = this.mensajes[0];\n      this.currentPage = pagina;\n      var pag = \"\";\n      if (pagina != null) {\n        pag = \"?page=\" + pagina;\n      }\n      var that = this;\n      this.$axios\n        .get(this.$localurl + \"/api/v1/messages/\" + this.$route.params.id + pag)\n        .then(function(response) {\n          response.data.messages.data.reverse();\n          that.mensajes = response.data.messages.data.concat(that.mensajes);\n          that.scrollToBottom();\n        })\n        .catch(function(response) {\n          if (response.response.status == 401) {\n            localStorage.removeItem(\"$expire\");\n            that.$router.push(\"/login\");\n          }\n        });\n    },\n    onScroll() {\n      var target = this.$refs.chatScroll;\n      if (target.scrollTop < target.clientHeight * 0.1) {\n        if (this.currentPage < this.lastPage) {\n          this.offset = this.offset + this.limit;\n          this.currentPage++;\n          this.getChatPage(this.currentPage);\n        }\n      }\n    },\n    scrollToBottom() {\n      var that = this;\n      this.$nextTick(() => {\n        if (that.mensajeOffset != null) {\n          document.getElementById(\n            \"chatScroll\"\n          ).scrollTop = document.getElementById(\n            that.mensajeOffset.id\n          ).offsetTop;\n        }\n      });\n    },\n    enviar() {\n      this.scrollToBottom();\n      var texto = this.$refs.inputTexto.value;\n      if (texto != \"\") {\n        this.$refs.inputTexto.value = \"\";\n        var data = new FormData();\n        data.append(\"message\", texto);\n        data.append(\"receiver_id\", this.$route.params.user_dest_id);\n        var that = this;\n        this.$axios\n          .post(this.$localurl + \"/api/v1/messages/textMessage\", data)\n          .then(function() {\n            that.getChat();\n          })\n          .catch(function(response) {\n            if (response.response.status == 401) {\n              localStorage.removeItem(\"$expire\");\n              that.$router.push(\"/login\");\n            }\n            alert(\"Se produjo un error, reintente\");\n          });\n      }\n    },\n    isOverflown(element) {\n      return (\n        element.scrollHeight > element.clientHeight ||\n        element.scrollWidth > element.clientWidth\n      );\n    },\n    adjuntar() {\n      this.$refs.adjuntoFiles.click();\n    },\n    changeAdjunto() {\n      if (this.$refs.adjuntoFiles.files.length > 0) {\n        var data = new FormData();\n        data.append(\"message\", \"archivos\");\n        data.append(\"receiver_id\", this.$route.params.user_dest_id);\n\n        this.$refs.adjuntoFiles.files.forEach(function(value, i) {\n          data.append(\"file[\" + i + \"]\", value);\n        });\n\n        var that = this;\n        this.$axios\n          .post(this.$localurl + \"/api/v1/messages/fileMessage\", data)\n          .then(function() {\n            that.getChat();\n          })\n          .catch(function(response) {\n            if (response.response.status == 401) {\n              localStorage.removeItem(\"$expire\");\n              that.$router.push(\"/login\");\n            }\n            alert(\"Se produjo un error, reintente\");\n          });\n      }\n    }\n  }\n};\n</script>\n\n<style scoped src=\"../assets/css/components/chat.css\"></style>\n<style scoped src=\"../assets/css/views/home.css\"></style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Chat.vue?vue&type=template&id=fb3e866a&scoped=true&\"\nimport script from \"./Chat.vue?vue&type=script&lang=js&\"\nexport * from \"./Chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"../assets/css/components/chat.css?vue&type=style&index=0&id=fb3e866a&scoped=true&lang=css&\"\nimport style1 from \"../assets/css/views/home.css?vue&type=style&index=1&id=fb3e866a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fb3e866a\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./home.css?vue&type=style&index=1&id=fb3e866a&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./home.css?vue&type=style&index=1&id=fb3e866a&scoped=true&lang=css&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./chat.css?vue&type=style&index=0&id=fb3e866a&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./chat.css?vue&type=style&index=0&id=fb3e866a&scoped=true&lang=css&\""],"sourceRoot":""}